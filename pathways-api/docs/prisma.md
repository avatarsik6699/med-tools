Prisma - –û–†–ú, –≤ —Å–æ—Å—Ç–∞–≤–µ –∫–æ—Ç–æ—Ä–æ–π –µ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç(Auto-generated and type-safe query builder for Node.js & TypeScript) + –º–æ–¥—É–ª—å –º–∏–≥—Ä–∞—Ü–∏–π.

–í—Å—ë –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å prisma.schema
In this schema, you configure three things:
- Data source: Specifies your database connection (via an environment variable)
- Generator: Indicates that you want to generate Prisma Client
	–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥ –¥–ª—è CRUD –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞–¥ –º–æ–¥–µ–ª—è–º–∏.
- Data model: Defines your application models


# Workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å Prisma
–î–æ–±–∞–≤–∏–ª–∏ –Ω–æ–≤—É—é –º–æ–¥–µ–ª—å ‚Üí npx prisma db push
- –ë—ã—Å—Ç—Ä–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å—Ö–µ–º—É —Å –ë–î
- –ù–µ —Å–æ–∑–¥–∞–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ (–∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏—è)
–ò–∑–º–µ–Ω–∏–ª–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –º–æ–¥–µ–ª—å ‚Üí npx prisma db push
- Prisma –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
- –ï—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã–µ - –ø—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç
–ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å Prisma Client ‚Üí npx prisma generate
- –û–±–Ω–æ–≤–ª—è–µ—Ç TypeScript —Ç–∏–ø—ã
- –û–±—ã—á–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ db push

–ö–æ–º–∞–Ω–¥—ã —Å–±—Ä–æ—Å–∞
prisma migrate reset --force (–≤–∞—à–∞ npm run db:reset)
–£–¥–∞–ª—è–µ—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ
–ü—Ä–∏–º–µ–Ω—è–µ—Ç –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∑–∞–Ω–æ–≤–æ
–û—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É _prisma_migrations
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–≥–¥–∞ —Ö–æ—Ç–∏—Ç–µ —á–∏—Å—Ç—É—é –ë–î —Å –∏—Å—Ç–æ—Ä–∏–µ–π –º–∏–≥—Ä–∞—Ü–∏–π
prisma db push --force-reset
–£–¥–∞–ª—è–µ—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É
–£–¥–∞–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É _prisma_migrations
–ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â—É—é —Å—Ö–µ–º—É
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–≥–¥–∞ —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —á–∏—Å—Ç—É—é –ë–î –±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏
–ö–æ–≥–¥–∞ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
Development —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ ‚Üí migrate reset
–ü—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–π ‚Üí db push --force-reset
–ó–∞–ø—É—Ç–∞–ª–∏—Å—å –≤ –º–∏–≥—Ä–∞—Ü–∏—è—Ö ‚Üí —É–¥–∞–ª–∏—Ç–µ prisma/migrations + db push --force-reset
–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –î–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ migrate reset, –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ - db push --force-reset.

# üß≠ –û–±—â–∞—è –∫–∞—Ä—Ç–∏–Ω–∞: –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã —Å Prisma
1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ‚Üí 2. –û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ ‚Üí 3. –ú–∏–≥—Ä–∞—Ü–∏—è ‚Üí 4. –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ ‚Üí 5. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ö–µ–º—ã ‚Üí 6. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
##  –®–∞–≥ 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
```sh  
npx prisma init
```
–°–æ–∑–¥–∞—Å—Ç: .env ‚Äî —Å DATABASE_URL –∏ prisma/schema.prisma ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª —Å—Ö–µ–º—ã
(–£–±–µ–¥–∏—Å—å, —á—Ç–æ DATABASE_URL —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –Ω—É–∂–Ω—É—é –ë–î (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–æ–∫–∞–ª—å–Ω—É—é PostgreSQL, SQLite –∏–ª–∏ –æ–±–ª–∞—á–Ω—É—é)). 
## üîπ  –®–∞–≥ 2: –û–ø–∏—Å–∞—Ç—å –º–æ–¥–µ–ª—å –≤ schema.prisma

// prisma/schema.prisma
model User {
  id    Int     @id @default(autoincrement())
  email String  @unique
  name  String?
}
## üîπ –®–∞–≥ 3: –°–æ–∑–¥–∞—Ç—å –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
```sh 
sql npx prisma migrate dev --name init 
```
–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
- Prisma —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é —Å—Ö–µ–º—É —Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ë–î
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç SQL-–º–∏–≥—Ä–∞—Ü–∏—é –≤ prisma/migrations/
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç –µ—ë –∫ –ë–î
- –û–±–Ω–æ–≤–ª—è–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ Prisma –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç Prisma Client
## üîÅ –®–∞–≥ 4: –í–Ω–µ—Å–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Å—Ö–µ–º—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ)
model User {
  id       Int     @id @default(autoincrement())
  email    String  @unique
  name     String?
  age      Int?    // ‚Üê –Ω–æ–≤–æ–µ –ø–æ–ª–µ
}

```sh 
npx prisma migrate dev --name add_age_to_user
```
Prisma:
- —É–≤–∏–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ
- —Å–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é (–ø–∞–ø–∫—É –≤ migrations/)
- –ø—Ä–∏–º–µ–Ω–∏—Ç ALTER TABLE –∫ –ë–î
- –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç Client

=/==/==/==/==/==/==/==/==/==/==/==/==/==/==/==/==/==/==/==/==/==/==/=
# –ü–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π –ø—Ä–∏ —Ä–∏—Å–∫–µ –ø–æ—Ç–µ—Ä—è—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Ö–æ–¥–µ –º–∏–≥—Ä–∞—Ü–∏–µ–π –∏ —Ç.–¥.
- —Å–æ–∑–¥–∞—Ç—å backup
- —Å–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é —Å —Ä—É—á–Ω—ã–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º 
```sh 
	npx prisma migrate dev --name SOME_NAME --create-only
```
- –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–π SQL —Ñ–∞–π–ª:
```sql
-- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
CREATE TABLE temp_nodes AS SELECT * FROM "Node";

-- –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é —Ç–∞–±–ª–∏—Ü—É
DROP TABLE "Node";

-- –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É (Prisma —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
CREATE TABLE "nodes" (
    "id" TEXT NOT NULL,
    "label" TEXT NOT NULL,
    CONSTRAINT "nodes_pkey" PRIMARY KEY ("id")
);

-- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å –∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π
INSERT INTO "nodes" ("id", "label") 
SELECT "id", "label" FROM temp_nodes;

-- –£–¥–∞–ª–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
DROP TABLE temp_nodes;
```
